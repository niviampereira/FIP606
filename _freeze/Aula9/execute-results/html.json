{
  "hash": "5c1d37630bdacccd81a6e66f552332d2",
  "result": {
    "markdown": "---\ntitle: \"Aula9\"\nauthor: \"Nívia\"\nformat: html\n---\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-1_6c4b88be432414a33f342cadebd93dc9'}\n\n```{.r .cell-code}\nlibrary(magrittr) # para usar pipes\nlibrary(ggplot2) # para gráficos\nlibrary(dplyr)\nlibrary(readxl)\nlibrary(tidyr)\n```\n:::\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-2_8b26ae85f6e13cf9d040005bc2be7227'}\n\n```{.r .cell-code}\ndata_mg <- read_excel(\"dados-diversos.xlsx\")\nhead(data_mg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n  trat    rep  comp\n  <chr> <dbl> <dbl>\n1 Mg2       1   9  \n2 Mg2       2  12.5\n3 Mg2       3  10  \n4 Mg2       4   8  \n5 Mg2       5  13.2\n6 Mg2       6  11  \n```\n:::\n:::\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-3_dd16e7d6c574500aec8f341af833b191'}\n\n```{.r .cell-code}\ndata2 <- data_mg %>%\n  group_by(trat) %>%\n  summarise(\n    mean_com = mean(comp),\n    sd_comp = sd(comp),\n    var_comp = var(comp),\n    n = n(),\n    se_comp = sd_comp / sqrt(n - 1),\n    ci = se_comp * qt(0,025, df = 9))\ndata2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 7\n  trat    mean_com sd_comp var_comp     n se_comp    ci\n  <chr>      <dbl>   <dbl>    <dbl> <int>   <dbl> <dbl>\n1 Mg2         10.5    1.54     2.39    10   0.515  -Inf\n2 control     15.7    1.27     1.61    10   0.424  -Inf\n```\n:::\n:::\n\n\nGráfico de barras vertical com erro padrão\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-4_f9ea6148e2de4476374fe384dbacc5eb'}\n\n```{.r .cell-code}\ndata2 |> \n  ggplot(aes(trat, mean_com)) +\n  geom_col(width = 0.5,\n           fill = \"steelblue\") +\n  geom_errorbar(aes(\n    ymin = mean_com - se_comp,\n    ymax = mean_com + se_comp),\n    width = 0.1) +\n  ylim(0,20) +\nlabs(x = \"\", y = \"Mean size (mm)\")\n```\n\n::: {.cell-output-display}\n![](Aula9_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nIntervalo de confiança\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-5_c8fc920c5abebde8ed38021a67146588'}\n\n```{.r .cell-code}\ndata2 |> \n  ggplot(aes(trat, mean_com)) +\n  geom_col(width = 0.5, fill = \"steelblue\") +\n  geom_errorbar(aes(\n    ymin = mean_com - ci,\n    ymax = mean_com + ci),\n    width = 0.1) +\n  ylim(0,20) +\nlabs(x = \"\", y = \"Mean size (mm)\")\n```\n\n::: {.cell-output-display}\n![](Aula9_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-6_efc07aed1cbdc98426c988c2f225a00c'}\n\n```{.r .cell-code}\ndata_mg2 <- data_mg |>\n  pivot_wider(1,\n              names_from = trat,\n              values_from = comp)\ndata_mg2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 3\n     rep   Mg2 control\n   <dbl> <dbl>   <dbl>\n 1     1   9      13.7\n 2     2  12.5    15.9\n 3     3  10      15.7\n 4     4   8      14.2\n 5     5  13.2    15.9\n 6     6  11      16.5\n 7     7  10.8    18  \n 8     8   9.5    14.4\n 9     9  10.8    16.4\n10    10  10.4    16  \n```\n:::\n:::\n\n\n## Teste de hipótese - teste t\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-7_46ec40d606625e448054167e734466d2'}\n\n```{.r .cell-code}\nt.test(data_mg2$Mg2, data_mg2$control, \npaired = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  data_mg2$Mg2 and data_mg2$control\nt = -8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -6.490393 -3.825607\nsample estimates:\nmean of x mean of y \n   10.520    15.678 \n```\n:::\n:::\n\n\nTeste t é um teste paramétrico e para ele precisa seguir 2 premissas - normalidade e homogeneidade da variância (homocedasticidade). Se precisa fazer transformação nos dados para deixá-los normais, pode.\n\n### Homocedastididade\n\nPodemos confirmar a premissa da homocedasticidade pelo teste F.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-8_1dbfd7765664a1367d594489d1fa50bf'}\n\n```{.r .cell-code}\nattach(data_mg2)\nvar.test(Mg2, control)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  Mg2 and control\nF = 1.4781, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3671417 5.9508644\nsample estimates:\nratio of variances \n          1.478111 \n```\n:::\n:::\n\n\n### Normalidade\n\nPara testar a normalidade dos dados, fazemos o teste shapiro.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-9_17473d37ea0e51ccf1717894b5938058'}\n\n```{.r .cell-code}\nshapiro.test(Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Mg2\nW = 0.97269, p-value = 0.9146\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(control)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  control\nW = 0.93886, p-value = 0.5404\n```\n:::\n:::\n\n\nAnálise visual da premissa de normalidade:\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-10_68d6355bb38f90ca09f6401f7df1ff90'}\n\n```{.r .cell-code}\nqqnorm (Mg2)\nqqline(Mg2)\n```\n\n::: {.cell-output-display}\n![](Aula9_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(control)\nqqline(control)\n```\n\n::: {.cell-output-display}\n![](Aula9_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n:::\n\n\nTestando um novo conjunto de dados:\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-11_3fde37ff148bb7fd74489b75470bb54e'}\n\n```{.r .cell-code}\nescala <- read_excel(\"dados-diversos.xlsx\", \"escala\")\nhead(escala)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n  assessment rater acuracia precisao vies_geral vies_sistematico vies_constante\n  <chr>      <chr>    <dbl>    <dbl>      <dbl>            <dbl>          <dbl>\n1 Unaided    A        0.809    0.826      0.979            1.19         0.112  \n2 Unaided    B        0.722    0.728      0.991            0.922       -0.106  \n3 Unaided    C        0.560    0.715      0.783            1.16         0.730  \n4 Unaided    D        0.818    0.819      0.999            0.948       -0.00569\n5 Unaided    E        0.748    0.753      0.993            1.10         0.0719 \n6 Unaided    F        0.695    0.751      0.925            0.802        0.336  \n```\n:::\n\n```{.r .cell-code}\nescala2 <- escala |> \n  select(assessment, rater, acuracia)\nescala3 <- escala2|>\n  pivot_wider(1,\n              names_from = assessment,\n              values_from = acuracia)\n```\n:::\n\n\n### Teste não paramétrico\n\nO Wilcox.test é o teste para dados não paramétricos equivalente ao teste t para dados paramétricos. o teste de Wilcoxon é usado para testar se as medianas das amostras são iguais nos casos em que a suposição de normalidade não é satisfeita ou quando não for possível checar essa suposição.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-12_5ec7b94bac730c20ae7bda1dd8e92e67'}\n\n```{.r .cell-code}\nwilcox.test(escala3$Aided1, escala3$Unaided, paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  escala3$Aided1 and escala3$Unaided\nV = 55, p-value = 0.001953\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}