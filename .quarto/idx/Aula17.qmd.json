{"title":"Aula17","markdown":{"yaml":{"title":"Aula17","author":"Nívia","format":"html"},"headingText":"Regressçao não-linear","containsRefs":false,"markdown":"\n\n\nQuando os dados não seguem um padrão linear, é necessário usar técnicas de regressão não linear para capturar a relação não linear entre as variáveis.\n\nRegressão não-linar para determinação de EC50:\n\n```{r}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(gsheet)\n```\n\nDados: usar o caminho do conjunto de dados sensibilidade a fungicidas, localizado na pasta do drive.\n```{r}\ndat <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/15pCj0zljvd-TGECe67OMt6sa21xO8BqUgv4d-kU8qi8/edit#gid=0\")\n```\n\nTrabalhando os dados:\n```{r}\noptions(scipen=999)\ndat2 <- dat |> \n  select(-Isolate, -Population) |>\n  group_by(Code, Year, Dose) |>\n  summarise(GC_mean = mean(GC))\n```\nO comando options(scipen=999) define a opção scipen para o valor 999. A opção scipen é usada para controlar a exibição de números científicos em notação exponencial. Definir scipen como 999 desativa a notação exponencial e exibirá os números completos.\n\nEsse bloco de comandos realiza uma sequência de operações no dataframe dat:\nRemove as colunas \"Isolate\" e \"Population\" (a coluna \"Isolate\" e a coluna \"Population\" não estarão presentes no resultado dat2).\nAgrupa os dados restantes por \"Code\", \"Year\" e \"Dose\".\nCalcula a média da coluna \"GC\" para cada grupo e armazena os resultados na coluna \"GC_mean\" em um novo dataframe chamado date, ou seja, summarise(GC_mean = mean(GC)) está sendo utilizado para calcular a média da coluna \"GC\" dentro de cada grupo definido pelas colunas \"Code\", \"Year\" e \"Dose\". A média resultante é atribuída a uma nova coluna chamada \"GC_mean\" no dataframe resultante.\n\n\nPara fazer um gráfico só com um dos isolados:\n```{r}\nFGT152 <- dat2 |>\n  filter(Code == \"FGT152\")\n\nFGT152 |>\n  ggplot(aes(factor(Dose), GC_mean))+\n  geom_point()+\n  geom_line()+\n  facet_wrap(~ Code)\n```\nCriou-se um gráfico usando o dataframe FGT152, que é um subconjunto dos dados filtrados do dat2. O gráfico mostra os valores de \"GC_mean\" em relação a \"Dose\" para o código \"FGT152\", com pontos e uma linha contínua. Os painéis separados são criados para cada nível único de \"Code\", mas neste caso, como só há \"FGT152\", há apenas um painel.\n\n\n## EC50 com pacote DRC\n\nO pacote DRC é especialmente útil para ajustar modelos de regressão dose-resposta e realizar análises estatísticas relacionadas. Ele oferece modelos para ajustar curvas de dose-resposta, incluindo modelos log-logísticos, log-probit, Weibull, etc. O pacote fornece funções para calcular estimativas de EC50.\n\n### Modelos\n\nModelo log.logistico3: o modelo de três parâmetros log-logístico descreve a relação entre a dose de um agente ou tratamento e a resposta biológica.\nEsse modelo assume uma resposta crescente ou decrescente com a dose e é frequentemente usado quando se espera uma resposta em forma de curva em S ou uma resposta em forma de S invertido.\n\n```{r}\nlibrary(drc)\n\ndrc1 <- drm(GC_mean ~ Dose, data = FGT152,\n            fct = LL.3())\nAIC(drc1)\nsummary(drc1)\nplot(drc1)\nED(drc1, 50)\n\n```\nO comando drc1 <- drm(GC_mean ~ Dose, data = FGT152, fct = LL.3()) : esses comandos são utilizados para ajustar um modelo de regressão de dose-resposta usando a função drm() da biblioteca 'drc' (dose-response modeling). O argumento GC_mean ~ Dose especifica que a variável resposta é \"GC_mean\" e a variável preditora é \"Dose\". O argumento data = FGT152 indica que os dados para ajuste do modelo são provenientes do dataframe FGT152. O argumento fct = LL.3() especifica o tipo de modelo a ser ajustado, neste caso, um modelo de três parâmetros log-logístico (LL.3()).\nAIC(drc1) é a função que utilizamos para calcular o AIC para o modelo ajustado. O AIC é uma medida que avalia a qualidade relativa do modelo, considerando a qualidade do ajuste e a complexidade do modelo. Quanto menor o valor do AIC, melhor o ajuste.\nA função ED(drc1, 50): calcula a dose efetiva (ED) para um determinado nível de resposta, neste caso, 50%. O comando ED() é usado para calcular as doses efetivas para um modelo de regressão de dose-resposta. O argumento drc1 especifica o modelo ajustado e o argumento 50 indica o nível de resposta desejado (50% neste caso).\n\n\nModelo W1.3: tem melhor ajuste atraves do AIC. Esse modelo permite uma maior flexibilidade na modelagem da forma da curva de resposta em relação à dose, pois inclui o parâmetro de assimetria (g). Esse parâmetro permite que a curva de resposta seja assimétrica, podendo assumir formas como curvas em forma de S assimétricas.\n\n```{r}\ndrc1 <- drm(GC_mean ~ Dose, data = FGT152,\n            fct = W1.3())\nAIC(drc1)\nsummary(drc1)\nplot(drc1)\nED(drc1, 50)\n```\n\n## Pacote ec50estimator\n\nFornece os valores de EC50 para os dados. É útil para comparar as estimativas de EC50 entre diferentes identificadores (ID) e identificar possíveis diferenças na resposta à dose.\n\n```{r}\nlibrary(ec50estimator)\n\ndf_ec50 <- estimate_EC50(GC_mean ~ Dose,\n                         data = dat2,\n                         isolate_col = \"Code\",\n                         interval = \"delta\",\n                         fct = drc::LL.3())\n\ndf_ec50 |>\n  ggplot(aes(Estimate, reorder(ID, Estimate)))+\n  geom_point()+\n  geom_errorbar(aes(xmin = Lower,\n                    xmax = Upper), width = 0.1)+\n  xlim(0,30)\n```\nA função estimate_EC50() é utilizada para estimar os valores de EC50 a partir dos dados. Dentro dessa função são usados varios argumentos, esses argumentos possuem diferentes papeis na função:\nO isolate_col = \"Code\" foi usado para definir a coluna \"Code\" como uma coluna de identificação única para diferentes amostras.\nO interval = \"delta\" define o tipo de intervalo de confiança que deverá ser calculado para as estimativas de EC50.\no comando fct = drc::LL.3() especifica o modelo de ajuste, neste caso, o modelo de três parâmetros log-logístico.\nDentro do ggplot e da função aes o argumento (Estimate, reorder(ID, Estimate)) especifica as variáveis a serem mapeadas nos eixos x e y do gráfico. \"Estimate\" corresponde aos valores estimados de EC50 e \"ID\" é reordenado de acordo com os valores de Estimate para controlar a ordem no gráfico.\nNesse caso, a função geom_errorbar adiciona barras de erro ao gráfico, utilizando os valores inferiores (Lower) e superiores (Upper) dos intervalos de confiança das estimativas de EC50. O xlim(0,30) define os limites do eixo x do gráfico, limitando o intervalo de visualização das estimativas até 30."},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula17.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","fontsize":"1.1em","theme":{"light":"minty","dark":"darkly"},"title":"Aula17","author":"Nívia"},"extensions":{"book":{"multiFile":true}}}}}