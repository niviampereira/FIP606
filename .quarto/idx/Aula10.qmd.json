{"title":"Aula10","markdown":{"yaml":{"title":"Aula10","author":"Nívia","format":"html"},"headingText":"Anova - 1 fator","containsRefs":false,"markdown":"\n\n\nQuando se trabalha com 2 tratamentos, os passos para seguir são: Teste de normalidade - shapiro.test, seguido de var.test, que se o p-valor der menor que 0,05 realiza testes não paramétricos (Mann-Whitney e Wilcoxon). Caso o p-vallor seja maior que 0,05, realiza-se o t.test ----\\> var.equal = F.\n\n## Anova com 1 fator\n\nPergunta a ser resposndida: Há efeito da espécie no crescimento micelial?\n\n```{r}\nlibrary(readxl)\nlibrary(tidyverse)\nmicelial <- read_excel(\"dados-diversos.xlsx\", \"micelial\")\nhead(micelial)\n\n```\n\n```{r}\nmicelial |>\n  ggplot(aes(especie, tcm))+\n  geom_boxplot()\n```\n\n###Usando AOV\n\nCria um novo modelo para atribuir a função aov() contendo os argumentos (tcm em função de espécie). Depois disso, resume o novo modelo criado com a função summary.\n\n```{r}\naov1 <- aov(tcm ~ especie, data = micelial)\nsummary(aov1)\n```\n\nConclusão: Nesse conjunto de dados, não há diferença na media micelial (não há efeito significativo da espécie sobre o cresc. micelial).\n\n### Testando as premissas\n\nDepois de fazer a anova, testa-se as premissas. É mais importante os dados serem homogeneos do que normais. Testando as premissas da anova - de normalidade e homocedasticidade do modelo: Para testar as premissas, é necessário instalar e carregar o pacote performance e o pacote DHARMa. O pacote performance permite checar as premissas (check\\_), já o pacote DHARMA ((Distributed Hierarchical Accumulation of Residuals for Generalized Linear Models in R) é para visualizar os dados pelo diagnóstico do resíduo (O pacote DHARMa permite faz uma comparação dos resíduos simulados, que são gerados pelo pacote, com os resíduos observados) e ver graficamente quando a distribuição dos dados não é normal e/ou quando há variação heterocedástica.\n\n```{r}\nlibrary(performance)\ncheck_heteroscedasticity(aov1)\ncheck_normality(aov1)\nlibrary(DHARMa)\nhist (aov1$residuals)\nqqnorm(aov1$residuals)\nqqline(aov1$residuals)\nplot(simulateResiduals(aov1))\nshapiro.test(aov1$residuals)\n```\n\n## Novo conjunto de dados - Dados não paramétricos\n\nAbrir um conjunto de dados que está no R chamado InsectSprays.\n\n```{r}\ninsects <- as_tibble(InsectSprays) |>\n  select(spray, count)\n```\n\n```{r}\ninsects |>\n  ggplot(aes(spray, count))+\n  geom_boxplot()\n```\n\nRodando o modelo de anova: como os dados, aparentemente - pelo visual do gráfico - apresentaram-se não paramétricos, roda-se a anova e testa-se as premissas para confirmação.\n\n```{r}\naov2 <- aov(count ~ spray, data = insects)\nsummary(aov2)\ncheck_normality(aov2)\ncheck_heteroscedasticity(aov2)\n```\n\nInterpretação: dados não são normais e homogeneos.\n\n### Alternativas para dados não paramétricos:\n\nQuando se tem dados não paramétricos, tem-se 3 alternativas - transformar os dados (raiz quadrada, log, etc); usar testes não paramétricos (Kruskal) ou usar modelos lineares generalizados (melhor opção).\n\n1.  Transformar os dados para normalizar: Usa-se a raiz quadrada para tentar noprmalizar e tornar os dados normais e homogenos. Pode-se também tentar o log da variável resposta + 0.5.\n\n```{r}\naov2 <- aov(sqrt(count) ~ spray, data = insects)\nsummary(aov2)\ncheck_normality(aov2)\ncheck_heteroscedasticity(aov2)\n```\n\n2.  Se não normalizar e os dados ainda forem heterogenos, usa-se testes não paramétricos. Tem 2 opções de teste Kruskal. Para usar essa opção, é necessário baixar e carregar o pacote agricolae.\n\n```{r}\nkruskal.test(count ~ spray, data = insects)\nlibrary(agricolae)\nkruskal(insects$count, insects$spray, \n        console = TRUE)\n```\n\n#### Pacote emmeans\n\nO pacote emmeans (\"estimated marginal means\", ou médias marginais estimadas) é usado para realizar testes de comparação de médias entre grupos, ajustando para outros fatores importantes que podem influenciar as médias. O pacote é particularmente útil em modelos lineares generalizados (GLM).\n\nFunção emmeans - tirar a média da variável inseticida: Para dar o valor original da média e não o valor transformado, usa-se a função type = response. A função pwpm gera uma tabela de comparação das médias e cld é uma função que serve para gerar os números que diferenciam os grupos de médias.\n\n```{r}\naov2 <- aov(count ~ spray, data = insects)\nsummary(aov2)\ncheck_normality(aov2)\ncheck_heteroscedasticity(aov2)\nlibrary(emmeans)\naov2_means <- emmeans(aov2, ~ spray,\n                         type = \"response\")\naov2_means\npwpm(aov2_means)\nlibrary(multcomp)\nlibrary(multcompView)\ncld(aov2_means)\n```\n\n3.  GLM A terceira opção é a geração de modelos lineares generalizados. Para publicação de artigos, essa é a opção mais aconselhável, é mais elegante do que transformar os dados. Para visualizar, pode usar o pacote Dharma e puxar um plot.\n\n```{r}\nglm1 <- glm(count ~spray,\n             data = insects,\n             family = poisson(link = \"identity\"))\nplot(simulateResiduals(glm1))\nsummary(glm1)\nglm1_means <- emmeans(glm1, ~ spray)\ncld(glm1_means)\n\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula10.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","fontsize":"1.1em","theme":{"light":"minty","dark":"flatly"},"title":"Aula10","author":"Nívia"},"extensions":{"book":{"multiFile":true}}}}}