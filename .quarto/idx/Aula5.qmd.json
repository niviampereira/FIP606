{"title":"Tipos de gráficos","markdown":{"yaml":{"title":"Tipos de gráficos","author":"Nívia","format":"html"},"headingText":"Tipos de gráficos e funções","containsRefs":false,"markdown":"\n\n\nExiste uma grande diversidade de gráficos que podem ser utilizados para representar dados. Os de uso mais comum em nossas aulas são: boxplots, scatterplots, histogramas, gráficos de linha e gráficos de barra e colunas.\n\n## BoxPlot\n\nBoxplots são úteis para estudarmos a distribuição de uma variável, principalmente quando queremos comparar várias distribuições. São frequentemente usados para representar dados numéricos, como medidas de tendência central, variabilidade e distribuição. Eles mostram a distribuição de um conjunto de dados por meio de um diagrama que inclui a mediana, quartis, outliers e limites do conjunto de dados. Os boxplots ajudam a visualizar a distribuição de um conjunto de dados e identificar possíveis outliers ou pontos de dados incomuns. Para construir um boxplot no ggplot, utilizamos a função geom_boxplot. Ele precisa dos atributos x e y, sendo que ao atributo x devemos mapear uma variável categórica.\n\nA função geom_boxplot compreende as seguintes estéticas: • outlier.color = NA: Retira a cor de fungo do boxplot; • fill = define a cor. O nome da cor, por ser texto, deve ser escrita entre aspas; • size = (número): define o tamanho do box, retorna um vetor numérico de comprimento length(x ).\n\n**Importação de dados**: sempre carregar primeiro o tidyverse e depois o pacote que irá usar para importar os dados, no caso de planilhas excel, o pacote readxl. Após isso, deve escolher a atribuição dos dados.\n\n```{r}\n#| warning: false\n#| message: false\nlibrary(tidyverse)\nlibrary(readxl)\nmg <- read_excel(\"dados-diversos.xlsx\")\n```\n\n**Visualização dos dados**: como abordado na aula aunterior, o ggplot é o pacote usado para visualização dos dados. Para visualizar os dados, basta usar a função ggplot.É importante que se defina antes quem será o eixo x e y (no caso, y é o comprimento da lesão, enquanto x são os tratamentos - controle e mg2). Depois, usa a função aes (aesthetic) do que deseja que apareça no gráfico e adiciona a camada geom_point para que os dados sejam vistos em forma de pontos.\n\n```{r}\nmg |> \n  ggplot(aes(trat, comp))+\n  geom_point()\n```\n\nMuitas vezes, ocorre a sobreposição de pontos no gráfico. Para desagregar esses pontos, usa-se a função geo_jitter(). Esta função adiciona variação aleatória aos pontos de localização do gráfico. Em outras palavras, ele \"agita\" ligeiramente as localizações dos pontos. Este método reduz o overplotting, pois é improvável que dois pontos com a mesma localização tenham a mesma variação aleatória. Para evitar que os dados fiquem muito dispersos, pode-se definir a largura (Width - controla a quantidade de deslocamento vertical).\n\n```{r}\nmg |> \n  ggplot(aes(trat, comp))+\n  geom_jitter(width = 0.1)\n```\n\nPara adicionar o boxplot e mudar a visão do gráfico, basta adicionar mais uma camada, ou seja, acionar a função geom_boxplot.\n\n```{r}\nmg |> \n  ggplot(aes(trat, comp))+\n  geom_boxplot()+\n  geom_jitter(width = 0.1)\n```\n\nPara tirar a cor do outlier, aumentar o tamanho dos pontos e colorir o boxplot:\n\n```{r}\np_box <- mg |> \n  ggplot(aes(trat, comp))+\n  geom_boxplot(outlier.color = NA,\n               fill = \"orange\",\n               size = 0.5)+\n  geom_jitter(width = 0.1,\n              height = 0,\n              color = \"black\")+\n  scale_y_continuous(limits = c(5,20), \n                     n.breaks = 10)+\n  labs(y = \"Lesion size (mm)\",\n       x = \" \")+\n  theme_bw()\np_box\nggsave(\"figs/plot2.png\", bg = \"white\")\n```\n\nPara sumarizar os dados, usa-se a summarise e função media da variável comprimento. Depois disso, transforma no ggplot e muda a estética. Para adicionar a barra de erro, usa-se a função errorbar. Para omitir os comandos das colunas, basta adicionar uma \\# na frente da linha de comando.\n\n```{r}\np_means <- mg |>\n  group_by(trat) |>\n  summarise(comp_mean = mean(comp),\n            comp_sd = sd(comp)) |>\n  ggplot(aes(trat, comp_mean))+\n  #geom_col(fill = \"orange\",\n           #width = 0.5)+\n  geom_point()+\n  scale_y_continuous(limits = c(7,18), \n                     n.breaks = 6)+\n  geom_errorbar(aes(ymin = comp_mean - comp_sd, \n                    ymax = comp_mean + comp_sd,\n                    width = 0.05))+\n  theme_bw()+\n  labs(y = \"Lesion size (mm)\",\n       x = \" \")\np_means\n#salvando gráfico\nggsave(\"figs/mean_sd.png\", \n       width = 4,\n       bg = \"white\")\n```\n\nInstalando o ggthemes e carregando pacote:\n\n```{r}\nlibrary(ggthemes)\n```\n\n### Composição de plots - Pacote PATCHWORK\n\nO patchwork torna possível combinar ggplots diferentes e separados em um mesmo gráfico. Depois de instalar, carrega o pacote. Primeiramente, deve-se definir um nome para cada gráfico. Os nomes devem ser dados dentro do chunk de cada gráfico. O nome deve ser escolhido e o banco de dados estudado deve ser atribuído a ele, tendo logo em seguida a necessidade de inserção de um pipe. Então, para unir diferentes ggplots, é necessário utilizar o título desses ggplots separados pelo sinal de + ou pela barra reta (\\|).\n\n```{r}\nlibrary(patchwork)\np_box + p_means\n\n#ou então usar a função abaixo\np_box | p_means\n\n# para adicionar letras A, B para identificar o grafico e adicionar titulo:\n(p_box | p_means)+\n  plot_annotation(tag_levels = \"A\",\n                  title = 'Gráficos que impressionam')\n\nggsave(\"figs/combined.png\")\n\n```\n\n## Gráfico de Colunas\n\nOs gráficos de colunas são usados para representar dados categóricos ou discretos (que podem ser divididos em grupos ou categorias). Um gráfico de colunas pode ajudar a identificar as tendências e padrões nos dados e destacar diferenças significativas entre as categorias. Para transformar gráficos em gráficos de colunas, usa-se a função geom_col (). Para esse tipo de gráficos, vamos utilizar o conjunto de dados survey. Para inverter as barras usa-se a função coord_flip().\n\n```{r}\nsurvey <- read_excel(\"dados-diversos.xlsx\",\n                     sheet = \"survey\")\nsurvey |> \n  filter(state == \"RS\") |>\n  #Para contar o numero de ocorrencias em cada classe:\n  count(species) |>\n  ggplot(aes(species, n))+\n  geom_col(width = 0.4,\n           fill = \"steelblue\")+\n  coord_flip()+\n  labs(x = \" \", y = \"Number of isolates\",\n       tiltle = \"Horizontal bar plot\",\n       subtitle = \"Using ggplot\")+\n  theme_bw()\n  ggsave(\"Figs/barplot.png\", bg = \"white\")\n  \n```\n\n**Adição de faceta**: Função facet_wrap\n\n```{r}\nsurvey |> \n  filter(state == \"RS\") |>\n  count(species, residue) |>\n  ggplot(aes(species, n))+\n  geom_col(width = 0.4,\n           fill = \"steelblue\")+\n  coord_flip()+\n  facet_wrap(~residue, ncol = 1)+\n  labs(x = \" \", y = \"Number of isolates\",\n       tiltle = \"Horizontal bar plot\",\n       subtitle = \"Using ggplot\")+\n  theme_bw()\n  ggsave(\"Figs/barplotfacet.png\", bg = \"white\")\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula5.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","fontsize":"1.1em","theme":{"light":"flatly","dark":"darkly"},"title":"Tipos de gráficos","author":"Nívia"},"extensions":{"book":{"multiFile":true}}}}}