{"title":"Aula13","markdown":{"yaml":{"title":"Aula13","author":"Nívia","format":"html"},"headingText":"Dados quantitativos e o uso de análise de regressão","containsRefs":false,"markdown":"\n\n\nQuando se tem dados quantitativos, a análise de regressão é geralmente mais apropriada do que a análise de variância (ANOVA), pois a análise de regressão permite estudar a relação entre uma variável dependente (Y) e uma ou mais variáveis independentes (X).\n\n```{r}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(ggplot2)\n```\n\n## Regressão linear simples\n\nNa regressão linear simples, testamos a hipótese de que a reta de regressão (linha de melhor ajuste), que representa a relação entre as variáveis independentes e a variável dependente, tem um coeficiente de inclinação diferente de zero. Ou seja, testamos a hipótese de que a inclinação da reta de regressão é significativamente diferente de zero (testa se o p valor é diferente de 0).\n\nConjunto de dados estande (dados-diversos): Visualização em ggplot\nPara ajustar para uma regressão linear usa-se o argumento method = \"lm\" dentro da função geom_smooth.\n\nEquação da R. LM simples: Y =  b1 - b2x\n```{r}\nestande <- read_excel(\"dados-diversos.xlsx\", \"estande\")\nestande |>\n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  facet_wrap(~ exp)+\n  geom_smooth(se =  F, method = \"lm\")\n```\nPosteriomente, deve-se testar o modelo que melhor se ajusta aos dados.Pode-se testar fazer a análise de regressão para cada experimento (isola cada experimento) ou analisar em grupos (modelos mistos).\n\n### Analisando cada experimento isoladamente:\n\nPara isso, cria um novo objeto para os dados (exp1) e atribui estande a ele, depois deve-se filtrar o experimento que deseja e criar um objeto para esse conjunto para viabilizar a realização da análise de regressão.\n\nExp 1:\n```{r}\nexp1 <- estande |>\n  filter(exp == 1)\n\nm1 <- lm(nplants ~trat, data = exp1)\nsummary(m1)\n```\nO valor do intercept e o valor de trat (slope) são utilizados na tabela.\nIntercept é o valor da variável dependente quando a variável independente é igual a zero. \nJá o slope é a medida da inclinação da linha de regressão, que representa a mudança na variável dependente associada a uma mudança na variável independente.\n\nPara o experimento 2:\n```{r}\nexp2 <- estande |>\n  filter(exp == 2)\n\nm2 <- lm(nplants ~trat, data = exp2)\nsummary(m2)\n```\n\nPara o exp3:\n```{r}\nexp3 <- estande |>\n  filter(exp == 3)\n\nm3 <- lm(nplants ~trat, data = exp3)\nsummary(m3)\n\nlibrary(report)\nreport(m3)\n```\n\nGráfico para representar a regressão - Para unir os 3 graficos, usa o patchwork.\n```{r}\ng1 <- exp1 |>\n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  geom_smooth(method = \"lm\", se = F)+\n  annotate(geom = \"text\", x = 24,\n           y = 70, label = \"y = 52.5 - 0.24x\")\n\ng2 <- exp2 |>\n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  geom_smooth(method = \"lm\", se = F)+\n  annotate(geom = \"text\", x = 24,\n           y = 70, label = \"y = 60 - 0.07x\")\ng3 <- exp3 |>\n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  geom_smooth(method = \"lm\", se = F)+\n  annotate(geom = \"text\", x = 24,\n           y = 70, label = \"y = 95 - 0.07x\")\n\nlibrary(patchwork)\ng1|g2|g3\n```\n\n## Modelo misto\n\nEm um modelo misto, as observações são divididas em grupos ou subgrupos. Cada grupo pode ter um conjunto diferente de efeitos aleatórios e/ou fixos, dependendo da estrutura dos dados. Por exemplo, se os dados foram coletados em diferentes locais geográficos, podemos ter um efeito aleatório para cada local (como no caso do conjunto de dados estande).\n\nEquação: b1 - b2x -  cx2\n\n```{r}\nlibrary(lme4)\nmix <- lmer(nplants ~trat + (trat | exp),\n            data = estande)\nsummary(mix)\n\nlibrary(car)\nAnova(mix)\n```\nQuando se usa o modelo misto, considera que todos os experimentos são agrupados, então considera que amostra é aleatória.\n\nPara fazer o modelo de regressão em grupo (misto) acrescenta-se na função aestetic o argumento group = exp. \n```{r}\nestande <- read_excel(\"dados-diversos.xlsx\", \"estande\")\nestande |>\n  ggplot(aes(trat, nplants, group = exp))+\n  geom_point()+\n  #facet_wrap(~ exp)+\n  geom_smooth(se =  F, method = \"lm\")\n```\n\nEm geral, os modelos mistos são mais poderosos do que os modelos que tratam cada experimento isoladamente, pois levam em conta a variação tanto entre quanto dentro dos experimentos. Além disso, os modelos mistos permitem que os dados sejam analisados em sua totalidade, sem perder informações importantes sobre a estrutura dos dados.\n\n# Modelo GLM\n\nO modelo linear generalizado é uma alternativa ao modelo linear. O GLM é considerado uma extensão do modelo linear que permite acomodar uma variedade de tipos de variáveis resposta, incluindo variáveis categóricas e contínuas. Além disso, o modelo linear generalizado permite que a relação entre a variável resposta e as variáveis explicativas seja não-linear. Ou seja, ele não se limita à suposição de que a relação é uma linha reta.\n\n```{r}\nlm1 <- lm(nplants ~ trat, data = exp3)\nsummary(lm1)\n\nglm1 <- glm(nplants ~ trat, family = \"gaussian\",\n            data = exp3)\n\nglm2 <- glm(nplants ~ trat, family = poisson(link = \"log\"),\n            data = exp3)\nAIC(glm1)\nAIC(glm2)\n\nsummary(glm1)\nsummary(glm2)\n```\n\nO modelo linear generalizado com distribuição gaussiana (family = gaussian) é usado quando a variável resposta é contínua e tem uma distribuição normal, ou seja, o mesmo que \"lm\".\nJá o modelo linear generalizado com distribuição de Poisson é usado quando a variável resposta é um número inteiro e não negativo e segue uma distribuição de Poisson (family = poisson).\nO AIC (Akaike's Information Criterion) é um critério de seleção de modelo usado para escolher o melhor modelo entre vários modelos candidatos. A escolha do modelo com o menor AIC é importante porque ele é uma medida de qualidade do modelo que leva em consideração tanto o ajuste aos dados quanto a complexidade do modelo. Como o AIC de menor valor é melhor, a família poisson é o ideal para os dados analisados.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula13.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"minty","title":"Aula13","author":"Nívia"},"extensions":{"book":{"multiFile":true}}}}}