{
  "hash": "aa436fa5889078190bc659616d53eb61",
  "result": {
    "markdown": "---\ntitle: \"ANOVA em DBC e parcela subdividida\"\nauthor: \"Nívia\"\nformat: html\n---\n\n\n# Anova com bloco (DBC)\n\n**Preparo pré-análise**:\n\n\n::: {.cell hash='Aula12_cache/html/unnamed-chunk-1_6a6aaff035cb90e676be22f452b3b62c'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\n```\n:::\n\n\nUsando o conjunto de dados fungicida_campo:\n\n\n::: {.cell hash='Aula12_cache/html/unnamed-chunk-2_bc1009cfdc7fb1e415d91ae9b01cb06a'}\n\n```{.r .cell-code}\nfungicidas <- read_excel(\"dados-diversos.xlsx\", \"fungicida_campo\")\n```\n:::\n\n\n## Modelo Anova com bloco\n\nNo delineamento em blocos, adiciona o sinal de + para adicionar a repetição.\n\n\n::: {.cell hash='Aula12_cache/html/unnamed-chunk-3_eba13ea7eedf16c8574d0ead58dc50c7'}\n\n```{.r .cell-code}\naov_fung <- aov(sev ~trat + rep, data = fungicidas)\nsummary(aov_fung)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)    \ntrat         7   7135  1019.3 287.661 <2e-16 ***\nrep          1     19    18.6   5.239 0.0316 *  \nResiduals   23     81     3.5                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n**Checando as premissas**:\n\n\n::: {.cell hash='Aula12_cache/html/unnamed-chunk-4_1d676661a6569268f8843f20c3d37d4c'}\n\n```{.r .cell-code}\nlibrary(performance)\nlibrary(DHARMa)\ncheck_normality(aov_fung)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.230).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fung)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.484).\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(aov_fung))\n```\n\n::: {.cell-output-display}\n![](Aula12_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n**Estimando as médias**:\n\n\n::: {.cell hash='Aula12_cache/html/unnamed-chunk-5_de781dca1ab7805fa9023af45bbe7944'}\n\n```{.r .cell-code}\nlibrary(emmeans)\nmeans_fung <- emmeans(aov_fung, ~trat)\nlibrary(multcomp)\nlibrary(multcompView)\ncld(means_fung)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n trat       emmean    SE df lower.CL upper.CL .group\n G            29.2 0.941 23     27.3     31.2  1    \n B            29.5 0.941 23     27.6     31.4  1    \n E            30.1 0.941 23     28.2     32.1  1    \n C            30.4 0.941 23     28.4     32.3  1    \n A            30.4 0.941 23     28.4     32.3  1    \n D            31.5 0.941 23     29.6     33.4  12   \n F            35.5 0.941 23     33.6     37.4   2   \n testemunha   75.8 0.941 23     73.8     77.7    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\nplot(means_fung)+\n  coord_flip()+\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Aula12_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n# Delineamento em parcela subdividida (Split-plot)\n\n**Preparo pré-ánalise**: usamos o conjunto milho,\n\n\n::: {.cell hash='Aula12_cache/html/unnamed-chunk-6_a28e9f864bb16fbadf40c723d8016310'}\n\n```{.r .cell-code}\nmilho <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n```\n:::\n\n\n**Ajustabndo o modelo**:\n\n\n::: {.cell hash='Aula12_cache/html/unnamed-chunk-7_5f39dcc39f6f7fddf10ffa690d78c53c'}\n\n```{.r .cell-code}\naov_milho_bloco <- aov(index ~ factor(block) + hybrid*method + \nError(factor(block)/hybrid/method), data = milho)\n\nsummary(aov_milho_bloco)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nError: factor(block)\n              Df Sum Sq Mean Sq\nfactor(block)  3  592.2   197.4\n\nError: factor(block):hybrid\n          Df Sum Sq Mean Sq F value Pr(>F)  \nhybrid     5  974.2  194.84    3.14 0.0389 *\nResiduals 15  930.9   62.06                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: factor(block):hybrid:method\n              Df Sum Sq Mean Sq F value Pr(>F)  \nmethod         1  79.61   79.61   4.726 0.0433 *\nhybrid:method  5 265.28   53.06   3.150 0.0324 *\nResiduals     18 303.18   16.84                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n**Checa as premissas**: Em parcelas subdivididas não é possível checar as premissas pelo check\\_, então usa lme4, para checar pelo modelo misto.\n\n\n::: {.cell hash='Aula12_cache/html/unnamed-chunk-8_eda12ec36e3d851063192c133997ec43'}\n\n```{.r .cell-code}\nlibrary(lme4)\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(index ~ block + hybrid*method + \n(1|block/hybrid), data =  milho)\n\nlibrary(car)\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(>Chisq)   \nblock          0.3192  3   0.956380   \nhybrid        15.6987  5   0.007759 **\nmethod         4.7262  1   0.029706 * \nhybrid:method 15.7498  5   0.007596 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.621).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.009).\n```\n:::\n:::\n\n\nComo os dados dão heterogneos, é necessário transformar os dados:\n\n\n::: {.cell hash='Aula12_cache/html/unnamed-chunk-9_8386e7ede2c3714667c502589179828a'}\n\n```{.r .cell-code}\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(sqrt(index) ~ block + hybrid*method + (1|block/hybrid), data = milho)\nlibrary(car)\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(index)\n                Chisq Df Pr(>Chisq)   \nblock          0.0764  3   0.994506   \nhybrid        15.4171  5   0.008721 **\nmethod         3.9239  1   0.047605 * \nhybrid:method 13.3025  5   0.020703 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.422).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.970).\n```\n:::\n:::\n\n\n**Comparação de médias**: Agora compara as médias, analisando a media para cada interação.\n\n\n::: {.cell hash='Aula12_cache/html/unnamed-chunk-10_6063f688684830af0c5c04ff21a62aec'}\n\n```{.r .cell-code}\nmeans_mix2 <- emmeans(mix2, ~hybrid | method)\nmeans_mix2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   5.00 1.17 5356     2.69     7.30\n 30F53 YH   4.95 1.17 5356     2.65     7.25\n 30K64      4.50 1.17 5356     2.20     6.81\n 30S31H     6.10 1.17 5356     3.79     8.40\n 30S31YH    5.63 1.17 5356     3.33     7.93\n BG7049H    4.40 1.17 5356     2.10     6.71\n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   4.94 1.17 5356     2.64     7.25\n 30F53 YH   5.10 1.17 5356     2.80     7.41\n 30K64      4.61 1.17 5356     2.31     6.91\n 30S31H     5.13 1.17 5356     2.83     7.43\n 30S31YH    5.14 1.17 5356     2.84     7.44\n BG7049H    4.37 1.17 5356     2.07     6.67\n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\ncld(means_mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    4.40 1.17 5356     2.10     6.71  1    \n 30K64      4.50 1.17 5356     2.20     6.81  1    \n 30F53 YH   4.95 1.17 5356     2.65     7.25  12   \n 30F53 HX   5.00 1.17 5356     2.69     7.30  12   \n 30S31YH    5.63 1.17 5356     3.33     7.93  12   \n 30S31H     6.10 1.17 5356     3.79     8.40   2   \n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    4.37 1.17 5356     2.07     6.67  1    \n 30K64      4.61 1.17 5356     2.31     6.91  1    \n 30F53 HX   4.94 1.17 5356     2.64     7.25  1    \n 30F53 YH   5.10 1.17 5356     2.80     7.41  1    \n 30S31H     5.13 1.17 5356     2.83     7.43  1    \n 30S31YH    5.14 1.17 5356     2.84     7.44  1    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\n#Se quer comparar os 2 métodos dentro de cada hibrido:\n#means_mix2 <- emmeans(mix2, ~ method | )\n#means_mix2\n#cld(means_mix2)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}