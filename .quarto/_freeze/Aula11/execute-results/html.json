{
  "hash": "85008a0cdb0cd73b5978aa45caa53e4c",
  "result": {
    "markdown": "---\ntitle: \"Aula11\"\nauthor: \"Nívia\"\nformat: html\n---\n\n\n# ANOVA - 2 ou mais fatores\n\nNa anova com 2 fatores ou mais, não se tem a opção de usar teste não paramétrico (Kruskal). O aov() em um fator é apenas resposta \\~ tratamento, mas com 2 ou mais o aov() é a resposta \\~ do tratamento \\* tratamento (ex.: resposta em função dos tratamento versus o cultivar).\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-1_8d7f64e568a8522679d8b6ddd7c2278f'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.0     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.1.8\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\n```\n:::\n\n\nBanco de dados utilizado: fungicida-vaso (conjunto de dados do dados diversos). Objeto nomeado como dat.\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-2_a05ef57fb34b2ffc9f005db3716f5e8e'}\n\n```{.r .cell-code}\ndat <- read_excel(\"dados-diversos.xlsx\", \"fungicida_vaso\")\n```\n:::\n\n\nCalculo da % do número de espigas com doença. Cria uma nova coluna:\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-3_3e0f5998cca90ee0ae823493fbac7cf7'}\n\n```{.r .cell-code}\ndat2 <- dat |>\n  mutate(inc = dis_sp / n_sp*100)\n\ndat2 |>\n  ggplot(aes(x = treat,\n             y = inc))+\n  geom_jitter(width = 0.1)+\n  facet_wrap(~dose)\n```\n\n::: {.cell-output-display}\n![](Aula11_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nGera modelo de anova: trata como dados qualitativos.\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-4_1f1f85c18f2525c4d14b937c944b0598'}\n\n```{.r .cell-code}\nm1 <- aov(inc ~treat*dose, \n          dat = dat2)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ntreat        1  919.5   919.5   24.31 0.000151 ***\ndose         1  920.9   920.9   24.34 0.000150 ***\ntreat:dose   1  747.7   747.7   19.76 0.000407 ***\nResiduals   16  605.3    37.8                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nCheca as premissas e visualiza com DHARMa:\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-5_2e35dfe2b1806ccfb461bc66a7176bb4'}\n\n```{.r .cell-code}\nlibrary(performance)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'performance' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.018).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'DHARMa' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThis is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in checkModel(fittedModel): DHARMa: fittedModel not in class of\nsupported models. Absolutely no guarantee that this will work!\n```\n:::\n\n::: {.cell-output-display}\n![](Aula11_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nComo está se trabalhando com dados de percentagem,tenta transformar os dados com log. Embora a normalidade pareça anormal, a homogeneidade é mais importante.\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-6_cc45abdaf3586fc149ca9abb9a639ec4'}\n\n```{.r .cell-code}\nm1 <- aov(log(inc + 0.5) ~ treat*dose, \n          dat = dat2)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)   \ntreat        1 12.928  12.928  13.980 0.00179 **\ndose         1  5.663   5.663   6.124 0.02491 * \ntreat:dose   1  5.668   5.668   6.129 0.02486 * \nResiduals   16 14.796   0.925                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.050).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.180).\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in checkModel(fittedModel): DHARMa: fittedModel not in class of\nsupported models. Absolutely no guarantee that this will work!\n```\n:::\n\n::: {.cell-output-display}\n![](Aula11_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nEstimando a média dos tratamentos para cada interação: primeiro os tratamentos dentro das doses e depois as dose dentro dos tratamentos.\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-7_dbb69ce06baddbfe72d1725eb1a5c49f'}\n\n```{.r .cell-code}\nlibrary(emmeans)\nmeans_m1 <- emmeans(m1, ~ treat | dose,\n                    type = \"response\")\nmeans_m1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndose = 0.5:\n treat        response     SE df lower.CL upper.CL\n Ionic liquid    27.05 11.847 16   10.570    68.05\n Tebuconazole     1.21  0.737 16    0.188     3.76\n\ndose = 2.0:\n treat        response     SE df lower.CL upper.CL\n Ionic liquid     3.10  1.412 16    1.065     7.77\n Tebuconazole     1.42  0.925 16    0.194     4.83\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log(mu + 0.5) scale \n```\n:::\n\n```{.r .cell-code}\nlibrary(multcompView)\nlibrary(multcomp)\ncld(means_m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndose = 0.5:\n treat        response     SE df lower.CL upper.CL .group\n Tebuconazole     1.21  0.737 16    0.188     3.76  1    \n Ionic liquid    27.05 11.847 16   10.570    68.05   2   \n\ndose = 2.0:\n treat        response     SE df lower.CL upper.CL .group\n Tebuconazole     1.42  0.925 16    0.194     4.83  1    \n Ionic liquid     3.10  1.412 16    1.065     7.77  1    \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log(mu + 0.5) scale \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\n#dose dentro dos tratamentos \n#means_ml <- emmeans(ml1, ~ dose | trat, type = \"response\")\n```\n:::\n\n\nVendo o coeficiente de variação:\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-8_6a4fafc8ce127940d313458987c80a68'}\n\n```{.r .cell-code}\nlibrary(agricolae)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'agricolae' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\ncv.model(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 65.04818\n```\n:::\n:::\n\n\n## Novo conjunto de dados - 3 fatores\n\nInteração entre tipo de armazenamento e umidade.\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-9_6d06e1d9de9ebfd85cb413269983483e'}\n\n```{.r .cell-code}\nmilho <- read_excel(\"dados-diversos.xlsx\", \"armazena\")\nmilho |>\n  filter(tempo ==8) |>\n  ggplot(aes(factor(tipo), peso_mil,\n             color = factor(umidade)))+\n  geom_jitter(width = 0.1)+\n  facet_wrap(~ umidade)\n```\n\n::: {.cell-output-display}\n![](Aula11_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nTestar a interação entre o tipo de armazenamento e o tempo 8:\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-10_4d3861ee951ea498f47270187a94d07d'}\n\n```{.r .cell-code}\nmilho2 <- milho |>\n  filter(tempo ==8)\n\nm2 <- aov(peso_mil ~ factor(tipo)*factor(umidade),\n          data = milho2)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                             Df Sum Sq Mean Sq F value   Pr(>F)    \nfactor(tipo)                  1  11215   11215  2375.8 3.64e-15 ***\nfactor(umidade)               2  42814   21407  4534.8  < 2e-16 ***\nfactor(tipo):factor(umidade)  2   2329    1165   246.7 1.79e-10 ***\nResiduals                    12     57       5                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\ntestanto tipo de inoculação na incidencia de fusarium em milho\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-11_e58e09267a9d73cd2b0227a1b893160e'}\n\n```{.r .cell-code}\nmilho3 <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n\nm4 <- aov(yield ~hybrid*method,\n          data = milho3)\nsummary(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              Df    Sum Sq  Mean Sq F value   Pr(>F)    \nhybrid         5 105876446 21175289   8.312 2.66e-05 ***\nmethod         1     42951    42951   0.017    0.897    \nhybrid:method  5  10619453  2123891   0.834    0.534    \nResiduals     36  91709593  2547489                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.928).\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m4))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in checkModel(fittedModel): DHARMa: fittedModel not in class of\nsupported models. Absolutely no guarantee that this will work!\n```\n:::\n\n::: {.cell-output-display}\n![](Aula11_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmedias_m4 <- emmeans(m4, ~ hybrid)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNOTE: Results may be misleading due to involvement in interactions\n```\n:::\n\n```{.r .cell-code}\nmedias_m4\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n hybrid   emmean  SE df lower.CL upper.CL\n 30F53 HX  10598 564 36     9453    11742\n 30F53 YH   9309 564 36     8165    10454\n 30K64     11018 564 36     9874    12162\n 30S31H     8652 564 36     7507     9796\n 30S31YH    8056 564 36     6912     9201\n BG7049H   12402 564 36    11257    13546\n\nResults are averaged over the levels of: method \nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\ncld(medias_m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n hybrid   emmean  SE df lower.CL upper.CL .group\n 30S31YH    8056 564 36     6912     9201  1    \n 30S31H     8652 564 36     7507     9796  12   \n 30F53 YH   9309 564 36     8165    10454  12   \n 30F53 HX  10598 564 36     9453    11742   23  \n 30K64     11018 564 36     9874    12162   23  \n BG7049H   12402 564 36    11257    13546    3  \n\nResults are averaged over the levels of: method \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\nCaso a interação não dê sifnificativa, tira a interação e deixa só o fator que teve significancia (isola o fator).\n\n\n::: {.cell hash='Aula11_cache/html/unnamed-chunk-12_db6864c50a48013496457eb3c0e2a9ea'}\n\n```{.r .cell-code}\nm5 <- aov(yield ~hybrid, data = milho3)\nsummary(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df    Sum Sq  Mean Sq F value   Pr(>F)    \nhybrid       5 105876446 21175289   8.688 1.02e-05 ***\nResiduals   42 102371996  2437428                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nm4 <- aov(yield ~hybrid,\n          data = milho3)\nsummary(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df    Sum Sq  Mean Sq F value   Pr(>F)    \nhybrid       5 105876446 21175289   8.688 1.02e-05 ***\nResiduals   42 102371996  2437428                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.763).\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m5))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in checkModel(fittedModel): DHARMa: fittedModel not in class of\nsupported models. Absolutely no guarantee that this will work!\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.25, log(sigma) = -3.814773 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.25, log(sigma) = -3.160253 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.25, log(sigma) = -3.228083 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.25, log(sigma) = -3.005742 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nUnable to calculate quantile regression for quantile 0.25. Possibly to few (unique) data points / predictions. Will be ommited in plots and significance calculations.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = -2.451225 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = -0.860418 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = -0.205899 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 0.198616 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 0.44862 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 0.603132 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 0.698625 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 0.757643 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 1.212159 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 2.521198 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 3.330228 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 3.830236 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 4.139259 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 4.248277 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 6.866355 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 8.484416 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 8.698647 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqu = 0.75, log(sigma) = 9.616835 : outer Newton did not converge fully.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWe had to increase `err` for some of the quantiles. See fit$calibr$err\n```\n:::\n\n::: {.cell-output-display}\n![](Aula11_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmedias_m5 <- emmeans(m5, ~hybrid)\nmedias_m5\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n hybrid   emmean  SE df lower.CL upper.CL\n 30F53 HX  10598 552 42     9484    11712\n 30F53 YH   9309 552 42     8195    10423\n 30K64     11018 552 42     9904    12132\n 30S31H     8652 552 42     7538     9765\n 30S31YH    8056 552 42     6942     9170\n BG7049H   12402 552 42    11288    13516\n\nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\ncld(medias_m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n hybrid   emmean  SE df lower.CL upper.CL .group\n 30S31YH    8056 552 42     6942     9170  1    \n 30S31H     8652 552 42     7538     9765  12   \n 30F53 YH   9309 552 42     8195    10423  123  \n 30F53 HX  10598 552 42     9484    11712   234 \n 30K64     11018 552 42     9904    12132    34 \n BG7049H   12402 552 42    11288    13516     4 \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\npwpm(medias_m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         30F53 HX 30F53 YH   30K64  30S31H 30S31YH BG7049H\n30F53 HX  [10598]   0.5709  0.9942  0.1494  0.0254  0.2125\n30F53 YH     1288  [ 9309]  0.2643  0.9576  0.5999  0.0036\n30K64        -420    -1709 [11018]  0.0447  0.0059  0.4938\n30S31H       1946      658    2366 [ 8652]  0.9723  0.0003\n30S31YH      2541     1253    2962     595 [ 8056]  <.0001\nBG7049H     -1804    -3092   -1384   -3750   -4345 [12402]\n\nRow and column labels: hybrid\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}