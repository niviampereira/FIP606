{
  "hash": "80d99d0d4faad9cd0ba72d467d6b41f7",
  "result": {
    "markdown": "---\ntitle: \"Análises estatísticas\"\nauthor: \"Nívia\"\nformat: html\n---\n\n\n# Tipos de testes para análise estatística\n\nVeremos nesta aula os tipos de análise de acordo com o número e tipo de variáveis independentes (níveis do fator) e também o número de tratamentos ou grupos a serem comparados.\n\n## Teste T\n\nO teste t compara DUAS MÉDIAS (2 tratamentos) e mostra se as diferenças entre essas médias são significativas. Como todo teste estatístico, o teste t também tem como produto a medida do valor de p. Ou seja, no final das contas, teremos calculado a probabilidade da diferença encontrada (entre as médias) terem sido por acaso. Existem 2 tipos mais comuns de teste t:\n\n-   teste t para 2 amostras **dependentes** (ou pareadas): compara as médias da [mesma população]{.underline} em diferentes momentos de tempo (ex.: antes e depois).\n\n-   teste t para 2 amostras **independentes** (ou não pareadas): compara as médias de [duas populações distintas]{.underline}.\n\nOs termos paramétrico e não-paramétrico referem-se à média e ao desvio-padrão, que são os parâmetros que definem as populações que apresentam distribuição normal. Veremos como trabalahar nessas duas diferentes sutuações.\n\n### Dois tratamentos independentes\n\n*Situação*:Um pesquisador conduziu um experimento com o objetivo de avaliar o efeito de um micronutriente, o magnésio (Mg), adicionado na solução do solo cultivado com plantas de arroz, no manejo de uma doença fúngica. O experimento foi conduzido em delineamento inteiramente casualizado com 10 repetições, sendo cada repetição um vaso de planta. Um dos tratamentos é o chamado controle, ou testemunha, sem o suplemento mineral. O segundo é aquele com o suplemento do Mg na dose de 2 mM. Em cada uma das repetições foi obtido um valor médio do comprimento de lesões em um determinado tempo após a inoculação.\n\n**Preparo pré-análise**: carregamento de pacotes e importação do conjunto de dados.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-1_c237af6da17cef399709eb1811acd185'}\n\n```{.r .cell-code}\nlibrary(magrittr) # para usar pipes\nlibrary(ggplot2) # para gráficos\nlibrary(dplyr)\nlibrary(readxl)\nlibrary(tidyr)\n```\n:::\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-2_8b26ae85f6e13cf9d040005bc2be7227'}\n\n```{.r .cell-code}\ndata_mg <- read_excel(\"dados-diversos.xlsx\")\nhead(data_mg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n  trat    rep  comp\n  <chr> <dbl> <dbl>\n1 Mg2       1   9  \n2 Mg2       2  12.5\n3 Mg2       3  10  \n4 Mg2       4   8  \n5 Mg2       5  13.2\n6 Mg2       6  11  \n```\n:::\n:::\n\n\nAgora, vamos começar a trabalhar esses dados e obter estatísticas que descrevem o conjunto de dados, seja a tendência central ou a dispersão dos dados. Neste caso, trabalhamos com a média (mean), variância (var), desvio padrão (sd), erro padrão (se) e intervalo de confiança (ci). O intervalo de confiança é apenas para inferência visual.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-3_dd16e7d6c574500aec8f341af833b191'}\n\n```{.r .cell-code}\ndata2 <- data_mg %>%\n  group_by(trat) %>%\n  summarise(\n    mean_com = mean(comp),\n    sd_comp = sd(comp),\n    var_comp = var(comp),\n    n = n(),\n    se_comp = sd_comp / sqrt(n - 1),\n    ci = se_comp * qt(0,025, df = 9))\ndata2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 7\n  trat    mean_com sd_comp var_comp     n se_comp    ci\n  <chr>      <dbl>   <dbl>    <dbl> <int>   <dbl> <dbl>\n1 Mg2         10.5    1.54     2.39    10   0.515  -Inf\n2 control     15.7    1.27     1.61    10   0.424  -Inf\n```\n:::\n:::\n\n\n**Visualização**: A maneira mais simples é visualizar, no caso de mais de 6 repetições, usando boxplots juntamente com os dados de cada repetição. Aqui visualizaremos os dados em gráfico de barras vertical com erro padrão.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-4_f9ea6148e2de4476374fe384dbacc5eb'}\n\n```{.r .cell-code}\ndata2 |> \n  ggplot(aes(trat, mean_com)) +\n  geom_col(width = 0.5,\n           fill = \"steelblue\") +\n  geom_errorbar(aes(\n    ymin = mean_com - se_comp,\n    ymax = mean_com + se_comp),\n    width = 0.1) +\n  ylim(0,20) +\nlabs(x = \"\", y = \"Mean size (mm)\")\n```\n\n::: {.cell-output-display}\n![](Aula9_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n*Intervalo de confiança*: Agora visualizamos os dados com o ci. Abaixo, as barras verticais representam o intervalo de confiança 95%.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-5_c8fc920c5abebde8ed38021a67146588'}\n\n```{.r .cell-code}\ndata2 |> \n  ggplot(aes(trat, mean_com)) +\n  geom_col(width = 0.5, fill = \"steelblue\") +\n  geom_errorbar(aes(\n    ymin = mean_com - ci,\n    ymax = mean_com + ci),\n    width = 0.1) +\n  ylim(0,20) +\nlabs(x = \"\", y = \"Mean size (mm)\")\n```\n\n::: {.cell-output-display}\n![](Aula9_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nO conjunto de dados está no formato largo, assim a variável resposta de interesse está apenas em uma coluna. Existem várias formas de separar em dois vetores os dados de resposta para cada tratamento. Uma delas é por meio da função pivot_winder, a qual coloca as respostas em duas colunas, uma para cada tratamento. Para isso, criaremos o conjunto data_mg2. Agora é posspivel visualizar as respostas (tamanho da lesão) para cada tratamento usando o conjunto de dados original, já que O ggplot2 requer os dados no formato largo.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-6_efc07aed1cbdc98426c988c2f225a00c'}\n\n```{.r .cell-code}\ndata_mg2 <- data_mg |>\n  pivot_wider(1,\n              names_from = trat,\n              values_from = comp)\ndata_mg2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 3\n     rep   Mg2 control\n   <dbl> <dbl>   <dbl>\n 1     1   9      13.7\n 2     2  12.5    15.9\n 3     3  10      15.7\n 4     4   8      14.2\n 5     5  13.2    15.9\n 6     6  11      16.5\n 7     7  10.8    18  \n 8     8   9.5    14.4\n 9     9  10.8    16.4\n10    10  10.4    16  \n```\n:::\n:::\n\n\n#### Teste de hipótese - teste t\n\nTeste t é um teste paramétrico e para ele precisa seguir 2 premissas - normalidade e homogeneidade da variância (homocedasticidade). Caso hja necessidade de transformação dos dados para deixá-los normais, é aceitável.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-7_46ec40d606625e448054167e734466d2'}\n\n```{.r .cell-code}\nt.test(data_mg2$Mg2, data_mg2$control, \npaired = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  data_mg2$Mg2 and data_mg2$control\nt = -8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -6.490393 -3.825607\nsample estimates:\nmean of x mean of y \n   10.520    15.678 \n```\n:::\n:::\n\n\nA ordem de execução dos testes deve ser: Shapiro.teste (teste de normalidade) \\> var.test (teste de homocedasticidade) \\> se p menor que 0,05 \\> t.test. No caso da variância dar heterogênea, var EQUAL = F. No caso dos dados pareados usa-se o argumento pared = TRUE\n\n##### Homocedastididade\n\nPodemos confirmar a premissa da homocedasticidade pelo teste F. No caso de dois grupos, a função que pode ser usada é a var.test do R. Vamos usar o formato largo e chamar os dois vetores do conjunto. Verifique o P-valor na saída da análise.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-8_1dbfd7765664a1367d594489d1fa50bf'}\n\n```{.r .cell-code}\nattach(data_mg2)\nvar.test(Mg2, control)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  Mg2 and control\nF = 1.4781, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3671417 5.9508644\nsample estimates:\nratio of variances \n          1.478111 \n```\n:::\n:::\n\n\nA verificação deste pressuposto também pode ser realizada graficamente através do boxplot para os tratamentos vs resíduos. Se existir homocedasticidade espera-se que os boxplots sejam semelhantes.\n\n##### Normalidade\n\nA normalidade pode ser testada por meio de procedimentos visuais e testes específicos. Para testar a normalidade dos dados, fazemos o teste shapiro.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-9_17473d37ea0e51ccf1717894b5938058'}\n\n```{.r .cell-code}\nshapiro.test(Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Mg2\nW = 0.97269, p-value = 0.9146\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(control)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  control\nW = 0.93886, p-value = 0.5404\n```\n:::\n:::\n\n\n**Análise visual da premissa de normalidade**: A análise visual da premissa de normalidade é realizada por qqplot (QQ-Plot), que permite verificar se uma amostra segue uma distribuição gaussiana. Podemos simplesmente fazer usando as funções qqnorm() e qqline() para cada umas das variáveis analisadas.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-10_68d6355bb38f90ca09f6401f7df1ff90'}\n\n```{.r .cell-code}\nqqnorm (Mg2)\nqqline(Mg2)\n```\n\n::: {.cell-output-display}\n![](Aula9_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(control)\nqqline(control)\n```\n\n::: {.cell-output-display}\n![](Aula9_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n:::\n\n\n### Dois tratamentos dependentes\n\nSe as premissas de normalidade não fossem atendidas, qual o teste que poderia ser usado? Nesse caso de dois grupos há duas possibilidades, uma é usar um teste não paramétrico ou um teste baseado em reamostragem (bootstrapping) dos dados, os quais independem do modelo de distribuição. Vejamos um exemplo.\n\n*Situação*: Um experimento foi conduzido para avaliar o efeito do uso da escala na acurácia e precisão de avaliações visuais de severidade por avaliadores. A hipótese a ser testada foi que avaliações utilizando uma escala digramática como auxílio são mais acuradas do que sem o uso do auxílio. Dez avaliadores foram escolhidos aleatoriamente e fizeram duas avaliações cada. Cinco variáveis que compõe a medida da concordância das estimativas foram obtidas. Uma vez que as medidas foram repetidas no tempo para cada avaliador, as amostras são do tipo dependentes.\n\n**Preparo pré-análise**: importação dos dados e preparo do conjunto.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-11_3fde37ff148bb7fd74489b75470bb54e'}\n\n```{.r .cell-code}\nescala <- read_excel(\"dados-diversos.xlsx\", \"escala\")\nhead(escala)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n  assessment rater acuracia precisao vies_geral vies_sistematico vies_constante\n  <chr>      <chr>    <dbl>    <dbl>      <dbl>            <dbl>          <dbl>\n1 Unaided    A        0.809    0.826      0.979            1.19         0.112  \n2 Unaided    B        0.722    0.728      0.991            0.922       -0.106  \n3 Unaided    C        0.560    0.715      0.783            1.16         0.730  \n4 Unaided    D        0.818    0.819      0.999            0.948       -0.00569\n5 Unaided    E        0.748    0.753      0.993            1.10         0.0719 \n6 Unaided    F        0.695    0.751      0.925            0.802        0.336  \n```\n:::\n\n```{.r .cell-code}\nescala2 <- escala |> \n  select(assessment, rater, acuracia)\nescala3 <- escala2|>\n  pivot_wider(1,\n              names_from = assessment,\n              values_from = acuracia)\n```\n:::\n\n\n**Checagem das premissas**:\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-12_6e84d308119156a54f047fcc2f6cdefb'}\n\n```{.r .cell-code}\n## homocedasticidade dois grupos\nattach(escala3)\nvar.test(Aided1, Unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  Aided1 and Unaided\nF = 0.17041, num df = 9, denom df = 9, p-value = 0.01461\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.04232677 0.68605885\nsample estimates:\nratio of variances \n         0.1704073 \n```\n:::\n\n```{.r .cell-code}\n## normalidade\nshapiro.test(Aided1)$p.value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4260888\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(Unaided)$p.value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1131276\n```\n:::\n:::\n\n\n*Análise visual da normalidade*:\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-13_596d65a6f3e52c90499bd8471825b520'}\n\n```{.r .cell-code}\nqqnorm(Aided1)\nqqline(Aided1)\n```\n\n::: {.cell-output-display}\n![](Aula9_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(Unaided)\nqqline(Unaided)\n```\n\n::: {.cell-output-display}\n![](Aula9_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n:::\n\n\n### Teste T paramétrico\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-14_4c80a6ea5599aa64e45394ce04ea34a4'}\n\n```{.r .cell-code}\n## teste t para amostras pareadas\nt_escala <- t.test(escala3$Aided1, escala3$Unaided,\n  paired = TRUE,\n  var.equal = F\n)\n\nt_escala\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPaired t-test\n\ndata:  escala3$Aided1 and escala3$Unaided\nt = 5.9364, df = 9, p-value = 0.000219\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 0.1144707 0.2554241\nsample estimates:\nmean difference \n      0.1849474 \n```\n:::\n:::\n\n\n### Teste para dados não paramétricos\n\nUm teste não paramétrico não faz nenhuma suposição sobre a distribuição da população ou tamanho da amostra. O Wilcox.test é o teste para dados não paramétricos equivalente ao teste t para dados paramétricos. o teste de Wilcoxon é usado para testar se as medianas das amostras são iguais nos casos em que a suposição de normalidade não é satisfeita ou quando não for possível checar essa suposição.\n\n\n::: {.cell hash='Aula9_cache/html/unnamed-chunk-15_f9f89ddbd625a0faadf6b364cb53431d'}\n\n```{.r .cell-code}\nwilcox.test(escala3$Aided1, escala3$Unaided, paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  escala3$Aided1 and escala3$Unaided\nV = 55, p-value = 0.001953\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}